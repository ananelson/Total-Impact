<h1>The Template Plugin</h1>

<h2>Introduction</h2>

<p><em>Replace this introduction with a description of your plugin</em></p>

<p>The template plugin is a template to use for the preparation of your own 
Total-Impact plugins. You should replace the text as noted in this 
documentation, the plugin itself, and the various test scripts. This
documentation is written using Dexy which means that the documents 
themselves will act as a test. If you run Dexy over your local repository
and you have everything setup correctly then your version of this document
should make sense.<p>

<p>The python plugins for Total-Impact have a simple structure with three
routines. The <em>run_plugin</em> method coordinates the action of the 
<em>get_data</em> and <em>parse_data</em> methods. The <em>main</em> method
simply handles parameter passing from the rest of the Total-Impact system.

<h2>Imports</h2>

<p><em>Replace this text with a description of the libraries you used</em></p>

<p>The additional libraries required for this plugin are <em>libraries</em>

{{get the import statement}}

<h2>The data source</h2>

<p><em>Replace the text in this section with a description relevant 
to your specific data source and identifiers</em></p>

<p>Our plugin obtains data from the <em>data-source</em> using a 
<em>identifier</em> as the identifier. We are using <em>identifier</em> as
the test identifier for this documentation.

{{show where the code places the base URL}}

{{show where the test code sets the test identifier}}

<h2>Plugin specific methods</h2>

<h3>run_plugin<h3>

<p><em>In most cases this method will not need to be changed, feel free to
remove this section if you haven't modified the run_plugin method</em><p>

<p>The run_plugin method coordinates the action of the other two core methods.
The first step is to check that the identifer is of the right type for this
data source. The ID_PATTERN variable is set</p>

{{show where the regex for the ID_PATTERN variable is set}}

<p>The method first checks that the <em>identifier</em> it has been passed 
matches the pattern specified</em>

{{show the check for the id pattern matching}}

<p>The method then obtains the page as specified by calling the 
<em>get_data</em> method. If a page is correctly 
received it then parses it using the <em>get_stats</em> method and returns
the response to Total-Impact core.

{{show rest of run_plugin method}}

<h3>get_data</h3>

<p><em>In most cases this method will not need to be changed, feel free to
remove this section if you haven't modified the get_data method. The
only place likely to require change is the fetching of the page itself
which might require encoding or some preprocessing or a more complex 
call</em><p>

<p>The get_data method first checks that an id has been passed to it and
if not it returns <em>None</em></p>

{{show checking of id}}

<p>The query URL is set by combining the BASE_DATA_URL with the id and 
an attempt is made to obtain the page. If successful the page is returned. If
a 404 is received then the routine returns <em>None</em>. If there is some
other error this is raised back up the request chain.</p>

{{show the remainder of get_data method}}

<h3>get_stats<h3>

<p><em>This is the core specific method of your plugin and should be clearly
documented as others will likely wish to build on it. The description for the
template method is necessarily a little vague.</em></p>

<p>The get_stats routine receives the raw (unless you've done some upstream
processing) page returned by get_data. The parsing will be specific to the
specific plugin and data source.</p>

<p>The method first checks that the page has been provided and if not it
returns <em>None</em>.<p>

{{show section checking that page is available}}

<p>The actual parsing routine is wrapped in a try clause in case of parsing
problems.</p>

{{show the parsing section}}

<p><em>If you wish to divide up your description of the parsing component of
your plugin you can easily add more sections by adding additonal ### @export 
markers to your code</em>.</p>

<p>The response to be sent to the total impact core is then wrapped as a
Python Dictionary/JSON object and returned.<p>

{{show the section that sets up the dictionary}}

<h3>main</h3>

<p><em>There should not be any need to change main. This is included only
for completeness sake and can be removed if you haven't modified main within
your plugin.</em></p>

<p>The main method accepts a command line argument from the Total-Impact
core and parses the arguments. As all plugins work to obtain data based on
one identifier from one data source this should only ever be called with one
argument which is checked. The run_plugin method is then called and the
final response returned back to the command line where it is collected.</p>

{{show the code for main}}




